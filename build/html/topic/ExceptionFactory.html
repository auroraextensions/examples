

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ExceptionFactory &#8212; Whiteboard 1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/styles.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Whiteboard 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ExceptionFactory</a></li>
<li><a class="reference internal" href="#related">Related</a></li>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#source">Source</a></li>
<li><a class="reference internal" href="#notes">Notes</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/topic/ExceptionFactory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#exceptionfactory" id="id2">ExceptionFactory</a></p></li>
<li><p><a class="reference internal" href="#related" id="id3">Related</a></p></li>
<li><p><a class="reference internal" href="#description" id="id4">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id6">Source</a></p></li>
<li><p><a class="reference internal" href="#notes" id="id7">Notes</a></p></li>
</ul>
</div>
<div class="section" id="exceptionfactory">
<h1><a class="toc-backref" href="#id2">ExceptionFactory</a><a class="headerlink" href="#exceptionfactory" title="Permalink to this headline">¶</a></h1>
<p><em>Published</em>: 2019-06-14</p>
</div>
<div class="section" id="related">
<h1><a class="toc-backref" href="#id3">Related</a><a class="headerlink" href="#related" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="DataObjectFactory">DataObjectFactory</a></p></li>
<li><p><a class="reference external" href="DateTimeFactory">DateTimeFactory</a></p></li>
</ul>
</div>
<div class="section" id="description">
<h1><a class="toc-backref" href="#id4">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h1>
<p>There are several benefits to using factories in Magento, namely flexible, stateless object
creation. As such, factories have become widely adopted and utilized in Magento 2, and can
be seen as one of the most significant architectural improvements over Magento 1. However,
it’s noticeable that exception creation practices have yet to embrace factories.</p>
<p>In the example below, we introduce the <code class="docutils literal notranslate"><span class="pre">ExceptionFactory</span></code> class, which can be used to create
<code class="docutils literal notranslate"><span class="pre">Throwable</span></code> exception types. The reasons for defining this class statically include:</p>
<ol class="arabic simple">
<li><p>Enforce <code class="docutils literal notranslate"><span class="pre">$type</span></code> argument to implement <code class="docutils literal notranslate"><span class="pre">Throwable</span></code> <a class="footnote-reference brackets" href="#ref1" id="id1">1</a> interface</p></li>
<li><p>Allow any <code class="docutils literal notranslate"><span class="pre">Throwable</span></code> exception type, instead of single exception type</p></li>
</ol>
<p><em>Please note</em>: The <code class="docutils literal notranslate"><span class="pre">ExceptionFactory</span></code> class will only <em>create</em> an exception type. It is the
responsibility of the invoking method to throw the created exception instance.</p>
</div>
<div class="section" id="usage">
<h1><a class="toc-backref" href="#id5">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">...</span>

<span class="x">$entity = $this-&gt;entityFactory-&gt;create();</span>
<span class="x">$this-&gt;entityResource-&gt;load(</span>
<span class="x">    $entity,</span>
<span class="x">    $id</span>
<span class="x">);</span>

<span class="x">if (!$entity-&gt;getId()) {</span>
<span class="x">    /** @var NoSuchEntityException $exception */</span>
<span class="x">    $exception = $this-&gt;exceptionFactory-&gt;create(</span>
<span class="x">      NoSuchEntityException::class,</span>
<span class="x">      __(&#39;No such entity found.&#39;)</span>
<span class="x">    );</span>

<span class="x">    throw $exception;</span>
<span class="x">}</span>
<span class="x">...</span>
</pre></div>
</div>
</div>
<div class="section" id="source">
<h1><a class="toc-backref" href="#id6">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h1>
<p>Below is an example <code class="docutils literal notranslate"><span class="pre">ExceptionFactory</span></code> that can be used in modules:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * ExceptionFactory.php</span>
<span class="sd"> *</span>
<span class="sd"> * Factory for generating various exception types.</span>
<span class="sd"> * Requires ObjectManager for instance generation.</span>
<span class="sd"> *</span>
<span class="sd"> * @link https://devdocs.magento.com/guides/v2.3/extension-dev-guide/factories.html</span>
<span class="sd"> */</span>
<span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>

<span class="k">namespace</span> <span class="nx">Vendor\Package\Exception</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Exception</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Magento\Framework\</span><span class="p">{</span>
    <span class="nx">ObjectManagerInterface</span><span class="p">,</span>
    <span class="nx">Phrase</span>
<span class="p">};</span>
<span class="k">use</span> <span class="nx">Throwable</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">ExceptionFactory</span>
<span class="p">{</span>
    <span class="sd">/** @constant string BASE_TYPE */</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">BASE_TYPE</span> <span class="o">=</span> <span class="nx">Exception</span><span class="o">::</span><span class="na">class</span><span class="p">;</span>

    <span class="sd">/** @constant string DEFAULT_ERROR */</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">DEFAULT_ERROR</span> <span class="o">=</span> <span class="s1">&#39;An error was encountered.&#39;</span><span class="p">;</span>

    <span class="sd">/** @property ObjectManagerInterface $objectManager */</span>
    <span class="k">protected</span> <span class="nv">$objectManager</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * @param ObjectManagerInterface $objectManager</span>
<span class="sd">     * @return void</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
        <span class="nx">ObjectManagerInterface</span> <span class="nv">$objectManager</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">objectManager</span> <span class="o">=</span> <span class="nv">$objectManager</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param string|null $type</span>
<span class="sd">     * @param Phrase|null $message</span>
<span class="sd">     * @return mixed</span>
<span class="sd">     * @throws Exception</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">create</span><span class="p">(</span>
        <span class="o">?</span><span class="nx">string</span> <span class="nv">$type</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">BASE_TYPE</span><span class="p">,</span>
        <span class="o">?</span><span class="nx">Phrase</span> <span class="nv">$message</span> <span class="o">=</span> <span class="k">null</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="sd">/** @var array $arguments */</span>
        <span class="nv">$arguments</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="cm">/* If no message was given, set default message. */</span>
        <span class="nv">$message</span> <span class="o">=</span> <span class="nv">$message</span> <span class="o">??</span> <span class="nx">__</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="na">ERROR_DEFAULT</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_subclass_of</span><span class="p">(</span><span class="nv">$type</span><span class="p">,</span> <span class="nx">Throwable</span><span class="o">::</span><span class="na">class</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span>
                <span class="nx">__</span><span class="p">(</span>
                    <span class="s1">&#39;Invalid exception type %1 was given.&#39;</span><span class="p">,</span>
                    <span class="nv">$type</span>
                <span class="p">)</span><span class="o">-&gt;</span><span class="na">__toString</span><span class="p">()</span>
            <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">!==</span> <span class="nx">self</span><span class="o">::</span><span class="na">BASE_TYPE</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$arguments</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$message</span><span class="o">-&gt;</span><span class="na">__toString</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$arguments</span><span class="p">[</span><span class="s1">&#39;phrase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$message</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">objectManager</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$type</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="notes">
<h1><a class="toc-backref" href="#id7">Notes</a><a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h1>
<dl class="footnote brackets">
<dt class="label" id="ref1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>The <cite>Throwable</cite> interface is a PHP built-in interface and can only be implemented via extending <cite>Exception</cite>.</p>
</dd>
</dl>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Whiteboard 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020 Aurora Extensions.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>
  </body>
</html>